# name: test/sql/snowflake_error_handling.test
# group: [sql]

# Snowflake Error Handling Tests
# These tests verify graceful fallback when pushdown fails

# Test 1: Invalid filter handling
# This should fall back to non-pushdown execution
query I rowsort
SELECT 1 as test_col;
----
1

# Test 2: Empty table handling
statement ok
CREATE TABLE empty_table AS SELECT * FROM (VALUES (1)) AS t(id) WHERE 1=0;

query I rowsort
SELECT COUNT(*) FROM empty_table WHERE id > 0;
----
0

# Test 3: NULL value handling
statement ok
CREATE TABLE null_test AS SELECT * FROM (VALUES 
    (1, NULL),
    (2, 'test'),
    (3, NULL)
) AS t(id, value);

query I rowsort
SELECT id FROM null_test WHERE value IS NULL;
----
1
3

query I rowsort
SELECT id FROM null_test WHERE value IS NOT NULL;
----
2

# Test 4: Type mismatch handling (should fall back gracefully)
query I rowsort
SELECT id FROM null_test WHERE TRY_CAST(value AS INTEGER) = 123;
----

# Test 5: Complex filter with potential errors
query I rowsort
SELECT id FROM null_test WHERE (id > 0 AND value IS NOT NULL) OR (id = 1);
----
1
2

# Clean up
statement ok
DROP TABLE empty_table;

statement ok
DROP TABLE null_test;
