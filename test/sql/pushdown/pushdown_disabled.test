# name: test/sql/pushdown/pushdown_disabled.test
# description: Test queries with pushdown disabled (default behavior)
# group: [pushdown]

require snowflake

statement ok
LOAD snowflake;

# Create test secret
statement ok
CREATE SECRET test_secret (
    TYPE snowflake,
    ACCOUNT 'FLWILYJ-FL43292',
    USER 'venkata@iqea.ai',
    PASSWORD 'DuckDBSnowflake2025',
    DATABASE 'SNOWFLAKE_SAMPLE_DATA'
);

# Test 1: ATTACH with pushdown disabled (default)
statement ok
ATTACH '' AS snow_disabled (TYPE snowflake, SECRET test_secret, READ_ONLY);

# Test 2: Simple projection query with pushdown disabled
statement ok
SELECT C_CUSTKEY, C_NAME FROM snow_disabled.tpch_sf1.customer WHERE C_CUSTKEY <= 5;

# Test 3: Verify results are correct
query II
SELECT C_CUSTKEY, C_NAME FROM snow_disabled.tpch_sf1.customer WHERE C_CUSTKEY <= 3 ORDER BY C_CUSTKEY;
----
1	Customer#000000001
2	Customer#000000002
3	Customer#000000003

statement ok
DETACH snow_disabled;